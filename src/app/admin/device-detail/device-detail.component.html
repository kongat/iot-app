<div class="container" *ngIf="device">
  <div class="py-5 text-center">
    <h2>Manage Device Form</h2>
    <p class="lead"></p>
  </div>
  <div class="row" *ngIf="device">
    <div class="col-md-8 offset-2" *ngIf="device">
      <h4 class="mb-3">Device Information</h4>
      <form class="needs-validation" novalidate>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="firstName">Device Name</label>
            <input
              [(ngModel)]="device.name"
              type="text"
              class="form-control"
              id="firstName"
              name="firstName"
              placeholder=""
              value=""
              required
            />
            <div class="invalid-feedback"></div>
          </div>
          <div class="col-md-6 mb-3">
            <label for="lastName">Status</label>
            <input
              [(ngModel)]="device.status"
              type="text"
              class="form-control"
              id="lastName"
              name="lastName"
              placeholder=""
              value=""
              required
            />
            <div class="invalid-feedback">Valid last name is required.</div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <div class="mb-3">
              <label for="username">Value</label>
              <div class="input-group">
                <input
                  [(ngModel)]="device.value"
                  type="text"
                  class="form-control"
                  id="role"
                  name="role"
                  placeholder="Username"
                  required
                />
                <div class="invalid-feedback" style="width: 100%;">
                  Your username is required.
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="mb-3">
              <label for="email">Room </label>
              <input
                [(ngModel)]="device.room"
                type="email"
                class="form-control"
                id="email"
                name="email"
                placeholder="you@example.com"
              />
              <div class="invalid-feedback">
                Please enter a valid email address for shipping updates.
              </div>
            </div>
          </div>
        </div>

        <button
          class="btn btn-primary btn-lg btn-block"
          (click)="saveDevice()"
          type="submit"
        >
          Update Device
        </button>
        <button class="btn btn-danger btn-lg btn-block" type="submit">
          Delete Device
        </button>
      </form>
    </div>
  </div>
  <div class="row">
    <div class="col-md-4 drag-column offset-2">
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-muted">Non Assigned Devices</span>
        <span class="badge badge-secondary badge-pill" *ngIf="this.nonAssignedUsers">{{
          this.nonAssignedUsers.length
        }}</span>
      </h4>
      <ul class="list-group mb-3" style="">
        <li
          *ngFor="let user of nonAssignedUsers"
          class="list-group-item d-flex justify-content-between lh-condensed"
          pDraggable="eeee"
          (onDragStart)="dragStart($event, user)"
          (onDragEnd)="dragEnd($event)"
        >
          <i class="fa fa-arrows fa-2x" style="float:right;margin-top:8px"></i>
          <img src="" style="float:left" draggable="false" />
          <div style="margin:8px 0 0 8px;float:left">
            {{ user.id }} - {{ user.name }}
          </div>
        </li>
      </ul>
    </div>
    <div
      class="col-md-4  drop-column"
      pDroppable="eeee"
      (onDrop)="drop($event)"
      [ngClass]="{ 'ui-highlight-car': draggedUser }"
    >
      <h4 class="d-flex justify-content-between align-items-center mb-3">
        <span class="text-muted">Assigned Users</span>
        <span class="badge badge-secondary badge-pill">{{
          device.users.length
        }}</span>
      </h4>
      <ul class="list-group mb-3" *ngFor="let user of device.users">
        <li class="list-group-item d-flex justify-content-between lh-condensed">
          <div>
            <h6 class="my-0">{{ user.name }}</h6>
          </div>
        </li>
        <li class="list-group-item d-flex justify-content-between">
          <span
            ><button type="button" class="btn btn-warning" (click)="unassignUser(user)">
              Unassign
            </button></span
          >
        </li>
      </ul>
    </div>
  </div>
</div>
